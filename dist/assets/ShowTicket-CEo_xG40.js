import{ba as R,a as z,c6 as v,q as O,r as b,c7 as W,j as a,C as A,T as t,S as d,B as y,aj as i,W as B,f as M,s as w}from"./index-D1uGZ479.js";function I(){var j;const{state:l}=R(),c=l==null?void 0:l.ticketId,g=z(),{data:p,isLoading:n}=v({id:c}),s=p==null?void 0:p.data,C={Subject:s==null?void 0:s.subject,Status:s==null?void 0:s.status,"Created on":s==null?void 0:s.createdAt,"Closed on":(s==null?void 0:s.status)==="CLOSED"?s==null?void 0:s.updatedAt:"Not closed yet"},{selectedTheme:u}=O(e=>e.themeMode),[h,f]=b.useState(""),[S,m]=b.useState(""),[D,{isLoading:L}]=W(),E=async e=>{var o,x;if(e.preventDefault(),!h.trim()){m("Reply message cannot be empty.");return}try{const r=await D({ticketId:c,message:h}).unwrap();r!=null&&r.status&&(m(""),g(w({open:!0,message:r==null?void 0:r.message,severity:"success"})),f(""))}catch(r){(o=r==null?void 0:r.data)!=null&&o.status||g(w({open:!0,message:((x=r==null?void 0:r.data)==null?void 0:x.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return a.jsxs(A,{sx:{display:"flex",flexDirection:"column",gap:"2rem"},children:[a.jsx(t,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",children:"Show Ticket"}),a.jsx(d,{sx:{bgcolor:u==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem",gap:"5px"},children:Object.entries(C).map(([e,o],x)=>a.jsxs(y,{sx:{display:"flex",gap:".5rem"},children:[a.jsx(t,{fontSize:"1rem",fontWeight:"700",children:n?a.jsx(i,{width:"200px"}):`${e} :`}),a.jsx(t,{sx:{color:o==="CLOSED"?"red":o==="Open"&&"green",fontSize:"1rem",fontWeight:"700"},children:n?a.jsx(i,{width:"200px"}):e==="Created on"||(s==null?void 0:s.status)==="CLOSED"&&e==="Closed on"?new Date(o).toLocaleString():o})]},x))}),a.jsx(d,{sx:{bgcolor:u==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem",gap:"15px"},children:((j=s==null?void 0:s.message)==null?void 0:j.length)>0&&(s==null?void 0:s.message).map((e,o)=>a.jsx(d,{sx:{flexFlow:(e==null?void 0:e.sender)==="user"&&"row-reverse",textAlign:(e==null?void 0:e.sender)==="user"?"right":"left"},children:a.jsxs(y,{sx:{display:"flex",flexDirection:"column"},children:[a.jsx(t,{sx:{fontSize:"1rem",fontWeight:"bold"},children:n?a.jsx(i,{width:"200px"}):(e==null?void 0:e.sender)==="user"?"You":"Admin"}),a.jsx(t,{children:n?a.jsx(i,{width:"200px"}):e==null?void 0:e.text}),a.jsx(t,{sx:{fontSize:"12px"},children:n?a.jsx(i,{width:"200px"}):new Date(e==null?void 0:e.time).toLocaleString()})]})}))}),a.jsxs(d,{sx:{bgcolor:u==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem"},component:"form",onSubmit:E,children:[a.jsx(t,{mb:"1rem",fontSize:"1.2rem",fontWeight:"bold",color:"primary.main",children:"Add reply"}),a.jsx(B,{name:"message",value:h,onChange:e=>f(e.target.value),multiline:!0,rows:3,placeholder:"Enter comment"}),S&&a.jsx(t,{color:"error",children:S}),a.jsx(M,{variant:"contained",disabled:L||(s==null?void 0:s.status)==="CLOSED"||n,type:"submit",sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"flex-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{I as default};

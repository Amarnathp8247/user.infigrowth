import{bw as c,a as E,q as y,a8 as M,a9 as B,r as x,cd as P,j as e,T as t,S as z,G as d,V as C,W as v,f as L,s as I,c as F,aT as D,u as W,M as R,ce as G,C as k,at as A}from"./index-D1uGZ479.js";import{O as N}from"./OverrideCommissionModal-CYH180fF.js";import"./KeyboardArrowDown-rOuSl0HJ.js";const H=c.object({planId:c.number({required_error:"Plan is required"}).nullable().refine(s=>s!==null,{message:"Plan is required"}),level1Commission:c.string().min(1,"Level 1 Commission is required"),level2Commission:c.string().min(1,"Level 2 Commission is required"),level3Commission:c.string().min(1,"Level 3 Commission is required"),level4Commission:c.string().min(1,"Level 4 Commission is required"),level5Commission:c.string().min(1,"Level 5 Commission is required"),level6Commission:c.string().min(1,"Level 6 Commission is required"),level7Commission:c.string().min(1,"Level 7 Commission is required")});function w({data:s,loading:i,setDataToEdit:l}){const r=E(),{selectedTheme:a}=y(S=>S.themeMode),j={planId:null,level1Commission:"",level2Commission:"",level3Commission:"",level4Commission:"",level5Commission:"",level6Commission:"",level7Commission:""},{register:n,handleSubmit:h,reset:g,formState:{errors:o}}=M({resolver:B(H),defaultValues:j});x.useEffect(()=>{s&&g({planId:Number(s==null?void 0:s.id)||null,level1Commission:String(s.level1Commission)||"",level2Commission:String(s.level2Commission)||"",level3Commission:String(s.level3Commission)||"",level4Commission:String(s.level4Commission)||"",level5Commission:String(s.level5Commission)||"",level6Commission:String(s.level6Commission)||"",level7Commission:String(s.level7Commission)||""})},[s,g]);const[f,{isLoading:b}]=P(),p=async S=>{var q,T;try{const m=await f(S).unwrap();m!=null&&m.status&&(r(I({open:!0,message:m==null?void 0:m.message,severity:"success"})),l(null))}catch(m){(q=m==null?void 0:m.data)!=null&&q.status||r(I({open:!0,message:((T=m==null?void 0:m.data)==null?void 0:T.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{my:"1.2rem"},children:["Total Granted Commission -: ",i?"-----":s==null?void 0:s.ibComission]}),e.jsxs(z,{variant:"section",sx:{border:`1px solid ${a=="dark"?"white":"black"}`,borderRadius:"1.2rem",padding:{xs:"1rem",md:"2rem"}},component:"form",onSubmit:h(p),children:[e.jsxs(d,{container:!0,size:12,spacing:3,children:[e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level1 Commission"}),e.jsx(v,{...n("level1Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level1 commission"}),o.level1Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level1Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level2 Commission"}),e.jsx(v,{...n("level2Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level2 commission"}),o.level2Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level2Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level3 Commission"}),e.jsx(v,{...n("level3Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level3 commission"}),o.level3Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level3Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level4 Commission"}),e.jsx(v,{...n("level4Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level4 commission"}),o.level4Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level4Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level5 Commission"}),e.jsx(v,{...n("level5Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level5 commission"}),o.level5Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level5Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level6 Commission"}),e.jsx(v,{...n("level6Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level6 commission"}),o.level6Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level6Commission.message})]}),e.jsxs(d,{item:!0,size:{xs:12,sm:6,md:4},children:[e.jsx(C,{sx:{mb:".5rem"},children:"Level7 Commission"}),e.jsx(v,{...n("level7Commission",{required:!0}),size:"small",fullWidth:!0,variant:"outlined",placeholder:"Enter Level7 commission"}),o.level7Commission&&e.jsx(t,{color:"error",fontSize:"14px",children:o.level7Commission.message})]})]}),e.jsxs(z,{sx:{flexDirection:"row",gap:"10px"},children:[e.jsx(L,{variant:"contained",type:"submit",disabled:b,sx:{textTransform:"capitalize",boxShadow:"none",color:"white",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Submit"}),e.jsx(L,{onClick:()=>l(null),sx:{textTransform:"capitalize",boxShadow:"none",mt:"1.5rem",alignSelf:"self-start","&:hover":{boxShadow:"none"}},children:"Cancel"})]})]})]})}const u=F(),O=s=>[u.accessor("group",{header:"Group Name",size:150,Cell:({row:i})=>{var l,r;return e.jsx(t,{children:(r=(l=i==null?void 0:i.original)==null?void 0:l.group)==null?void 0:r.name})}}),u.accessor("level1Commission",{header:"Level1 Commission",size:100,Cell:({row:i})=>{var r,a;const l=(r=i==null?void 0:i.original)==null?void 0:r.planId;return e.jsx(D,{btnName:(a=i==null?void 0:i.original)==null?void 0:a.level1Commission,type:"text",Content:N,contentData:{planId:l,level:"1"}})}}),u.accessor("level2Commission",{header:"Level2 Commission",size:100}),u.accessor("level3Commission",{header:"Level3 Commission",size:100}),u.accessor("level4Commission",{header:"Level4 Commission",size:100}),u.accessor("level5Commission",{header:"Level5 Commission",size:100}),u.accessor("level6Commission",{header:"Level6 Commission",size:100}),u.accessor("level7Commission",{header:"Level7 Commission",size:100}),u.accessor("action",{header:"Action",size:150,Cell:({row:i})=>{const l=i.original;return e.jsx(L,{onClick:()=>s(l),variant:"contained",sx:{textTransform:"none",color:"white",fontSize:"0.7rem",px:"8px",py:"4px"},children:"Edit"})}})];function V({data:s,isError:i,showError:l,loading:r,handleDataToEdit:a,pagination:j,setPagination:n,globalFilter:h,setGlobalFilter:g}){const o=x.useMemo(()=>O(a),[]),f=x.useMemo(()=>s==null?void 0:s.ibPlanList,[s==null?void 0:s.ibPlanList]),b=x.useMemo(()=>(s==null?void 0:s.totalRecords)||0,[s]),p=W({columns:o,data:f,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:b,state:{pagination:j,globalFilter:h,loading:r,showAlertBanner:i},onPaginationChange:n,onGlobalFilterChange:g,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:i?{color:"error",children:l||"Error loading Commission List."}:void 0});return e.jsx(z,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:e.jsx(R,{table:p})})}function J(){var p;const[s,i]=x.useState(null),[l,r]=x.useState({pageIndex:0,pageSize:10}),[a,j]=x.useState(""),{data:n,isLoading:h,isError:g,error:o}=G({page:l.pageIndex+1,sizePerPage:l.pageSize,search:a}),f=n==null?void 0:n.data,b=(p=o==null?void 0:o.data)==null?void 0:p.message;return e.jsxs(k,{children:[e.jsx(t,{sx:{fontSize:"2rem",fontWeight:"700"},children:"Set IB Commission"}),h?e.jsx(A,{}):e.jsx(V,{data:f,loading:h,isError:g,showError:b,handleDataToEdit:i,pagination:l,setPagination:r,globalFilter:a,setGlobalFilter:j}),s&&e.jsx(w,{data:s,setDataToEdit:i})]})}export{J as default};
